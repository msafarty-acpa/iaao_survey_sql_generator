library(readxl)
library(dplyr)
data<-readxl::read_excel('2017_PTAPP-web (1).xlsx', sheet = 1)


data1<-readxl::read_excel('2017_PTAPP-web (1).xlsx', sheet = 1)
data2<-readxl::read_excel('2017_PTAPP-web (1).xlsx', sheet = 2)
data3<-readxl::read_excel('2017_PTAPP-web (1).xlsx', sheet = 3)
data4<-readxl::read_excel('2017_PTAPP-web (1).xlsx', sheet = 4)
data <- cbind(data1,data2,data3,data4)
#not perfect because we are not auto looking up the values for categoy/subquestion, but we can enter them into function args and still be a lot more efficient than previous method
generateSql <- function(dataset, qnum, colnum, category, subQ) {
  sqlText <- dataset %>% select(c(2,colnum+2)) %>% filter(!is.na(`...2`) )
  for (row in 1:nrow(sqlText)) {
   print(paste0("(2, ", 1000+row, ", 2017, ",qnum, ", ", category, ", ", 
                subQ,", '", sqlText[row,2], "'),"), quote = F)
  }                
}
generateSql(data1, 2, 1, 'NULL','NULL')
generateSql(data1, 3, 2, 'NULL','NULL')
generateSql(data1, 4, 3, 'NULL', 10001)
generateSql(data1, 4, 4, 'NULL', 10001)
# generateSql(data1,4, 5, 'NULL', 10002)
generateSql(data1, 5, 6, 'NULL', 10003)
generateSql(data1, 5, 7, 'NULL', 10004)
generateSql(data1, 5, 8, 'NULL', 10005)
generateSql(data1, 5, 9, 'NULL', 10006)
generateSql(data1, 5, 10, 'NULL', 10007)
generateSql(data1, 5, 11, 'NULL', 10008)
generateSql(data1, 5, 12, 'NULL', 10009)
generateSql(data1, 5, 13, 'NULL', 10010)
generateSql(data1, 5, 14, 'NULL', 10011)
generateSql(data1, 5, 15, 'NULL', 10012)
generateSql(data1, 5, 16, 'NULL', 10013)
generateSql(data1, 5, 17, 'NULL', 10014)
generateSql(data1, 5, 18, 'NULL', 10015)
generateSql(data1, 5, 19, 'NULL', 10016)
generateSql(data1, 5, 20, 'NULL', 10017)
generateSql(data1, 5, 21, 'NULL', 10018)
#5,22 "see appendix"
generateSql(data1, 6, 23, 'NULL', 'NULL')
generateSql(data1, 7, 24, 'NULL', 'NULL')
generateSql(data1, 8, 25, 'NULL', 10019)
generateSql(data1, 8, 26, 'NULL', 10020)
generateSql(data1, 8, 27, 'NULL', 10021)
generateSql(data1, 8, 28, 'NULL', 10022)
generateSql(data1, 8, 29, 'NULL', 10023)
generateSql(data1, 8, 30, 'NULL', 10024)
generateSql(data1, 8, 31, 'NULL', 10025)
generateSql(data1, 8, 32, 'NULL', 10026)
generateSql(data1, 8, 33, 'NULL', 10027)
generateSql(data1, 8, 34, 'NULL', 10028)
generateSql(data1, 8, 35, 'NULL', 10029)
generateSql(data1, 8, 36, 'NULL', 10030)
generateSql(data1, 8, 37, 'NULL', 10031)
generateSql(data1, 8, 38, 'NULL', 10032)
generateSql(data1, 8, 39, 'NULL', 10033)
generateSql(data1, 8, 40, 'NULL', 10034)
generateSql(data1, 8, 41, 'NULL', 10035)
generateSql(data1, 8, 42, 'NULL', 10036)
generateSql(data1, 8, 43, 'NULL', 10037)
generateSql(data1, 8, 44, 'NULL', 10038)
#45 see appendix
generateSql(data1, 9, 46, 'NULL', 10039)
generateSql(data1, 9, 47, 'NULL', 10040)
#48 see appendix
generateSql(data1, 10, 49, 'NULL', 10041)
generateSql(data1, 10, 50, 'NULL', 10042)
generateSql(data1, 10, 51, 'NULL', 10043)
generateSql(data1, 10, 52, 'NULL', 10044)
generateSql(data1, 10, 53, 'NULL', 10045)
generateSql(data1, 10, 54, 'NULL', 10046)
generateSql(data1, 10, 55, 'NULL', 10047)
generateSql(data1, 10, 56, 'NULL', 10048)
generateSql(data1, 10, 57, 'NULL', 10049)
generateSql(data1, 10, 58, 'NULL', 10050)
#59 see appendix
#excel question 11 on separate sheet
generateSql(data2, 11, 2, 'NULL', 10051)
generateSql(data2, 11, 3, 'NULL', 10052)
generateSql(data2, 11, 4, 'NULL', 10053)
generateSql(data2, 11, 5, 'NULL', 10054) #see appendix
generateSql(data2, 12, 6, 'NULL', 'NULL')
generateSql(data2, 13, 7, 'NULL', 'NULL')
generateSql(data2, 14, 8, 'NULL', 10055)
generateSql(data2, 14, 9, 'NULL', 10056)
generateSql(data2, 15, 10, 'NULL', 10057)
generateSql(data2, 15, 11, 'NULL', 10058)
generateSql(data2, 15, 12, 'NULL', 10059)
generateSql(data2, 16, 13, 1601, 10060)
generateSql(data2, 16, 14, 1601, 10061)
generateSql(data2, 16, 15, 1601, 10062)
generateSql(data2, 16, 16, 1602, 10063)
generateSql(data2, 16, 17, 1602, 10064)
generateSql(data2, 16, 18, 1602, 10065)
generateSql(data2, 16, 19, 1603, 10066)
generateSql(data2, 16, 20, 1603, 10067)
generateSql(data2, 16, 21, 1603, 10068)
generateSql(data2, 16, 22, 1604, 10069)
generateSql(data2, 16, 23, 1604, 10070)
generateSql(data2, 16, 24, 1604, 10071)
generateSql(data2, 16, 25, 1605, 10072)
generateSql(data2, 16, 26, 1605, 10073)
generateSql(data2, 16, 27, 1605, 10074)
generateSql(data2, 16, 28, 1606, 10075)
generateSql(data2, 16, 29, 1606, 10076)
generateSql(data2, 16, 30, 1606, 10077)
generateSql(data2, 16, 31, 1607, 10078)
generateSql(data2, 16, 32, 1607, 10079)
generateSql(data2, 16, 33, 1607, 10080)
generateSql(data2, 16, 34, 1608, 10081)
generateSql(data2, 17, 35, 1701, 10082)
generateSql(data2, 17, 36, 1701, 10083)
generateSql(data2, 17, 37, 1701, 10084)
generateSql(data2, 17, 38, 1702, 10085)
generateSql(data2, 17, 39, 1702, 10086)
generateSql(data2, 17, 40, 1702, 10087)
generateSql(data2, 17, 41, 1703, 10088)
generateSql(data2, 17, 42, 1703, 10089)
generateSql(data2, 17, 43, 1703, 10090)
generateSql(data2, 17, 44, 1704, 10091)
generateSql(data2, 17, 45, 1704, 10092)
generateSql(data2, 17, 46, 1704, 10093)
generateSql(data2, 17, 47, 1705, 10094)
generateSql(data2, 17, 48, 1705, 10095)
generateSql(data2, 17, 49, 1705, 10096)
generateSql(data2, 18, 50, 'NULL', 10097)
generateSql(data2, 18, 51, 'NULL', 10098)
generateSql(data2, 18, 52, 'NULL', 10099)
generateSql(data2, 18, 53, 'NULL', 10100)
generateSql(data2, 18, 54, 'NULL', 10101)
generateSql(data2, 18, 55, 'NULL', 10102)
generateSql(data2, 19, 56, 'NULL', 10103)
generateSql(data2, 19, 57, 'NULL', 10104)
generateSql(data2, 20, 58, 'NULL', 10105)
generateSql(data2, 20, 59, 'NULL', 10106)
generateSql(data2, 20, 60, 'NULL', 10107)
generateSql(data2, 20, 61, 'NULL', 10108)
generateSql(data2, 20, 62, 'NULL', 10109)
generateSql(data2, 20, 63, 'NULL', 10110)
generateSql(data2, 20, 64, 'NULL', 10111)
generateSql(data2, 20, 65, 'NULL', 10112)
# spreadsheet tab 3 for q21-32
generateSql(data3, 21, 2, 2101, 10113)
generateSql(data3, 21, 3, 2101, 10114)
generateSql(data3, 21, 4, 2101, 10115)
generateSql(data3, 21, 5, 2102, 10116)
generateSql(data3, 21, 6, 2102, 10117)
generateSql(data3, 21, 7, 2102, 10118)
generateSql(data3, 21, 8, 2103, 10119)
generateSql(data3, 21, 9, 2103, 10120)
generateSql(data3, 21, 10, 2103, 10121)
generateSql(data3, 21, 11, 2104, 10122)
generateSql(data3, 21, 12, 2104, 10123)
generateSql(data3, 21, 13, 2104, 10124)
generateSql(data3, 21, 14, 2105, 10125)
generateSql(data3, 21, 15, 2105, 10126)
generateSql(data3, 21, 16, 2105, 10127)
generateSql(data3, 21, 17, 2106, 10128)
generateSql(data3, 21, 18, 2106, 10129)
generateSql(data3, 21, 19, 2106, 10130)
generateSql(data3, 21, 20, 2107, 10131)
generateSql(data3, 21, 21, 2107, 10132)
generateSql(data3, 21, 22, 2107, 10133)
generateSql(data3, 21, 23, 2108, 10134)
generateSql(data3, 21, 24, 2108, 10135)
generateSql(data3, 21, 25, 2108, 10136)
generateSql(data3, 21, 26, 2109, 10137)
generateSql(data3, 21, 27, 2109, 10138)
generateSql(data3, 21, 28, 2109, 10139)
generateSql(data3, 21, 29, 2110, 10140)
generateSql(data3, 21, 30, 2110, 10141)
generateSql(data3, 21, 31, 2110, 10142)
generateSql(data3, 21, 32, 2111, 10143)
generateSql(data3, 21, 33, 2111, 10144)
generateSql(data3, 21, 34, 2111, 10145)
generateSql(data3, 21, 35, 2112, 10146)
generateSql(data3, 21, 36, 2112, 10147)
generateSql(data3, 21, 37, 2112, 10148)
generateSql(data3, 21, 38, 2113, 10149)
generateSql(data3, 21, 39, 2113, 10150)
generateSql(data3, 21, 40, 2113, 10151)
generateSql(data3, 21, 41, 2114, 10152)
generateSql(data3, 21, 42, 2114, 10153)
generateSql(data3, 21, 43, 2114, 10154)
generateSql(data3, 21, 44, 2115, 10155)
generateSql(data3, 21, 45, 2115, 10156)
generateSql(data3, 21, 46, 2115, 10157)
generateSql(data3, 21, 47, 2116, 10158)
generateSql(data3, 21, 48, 2116, 10159)
generateSql(data3, 21, 49, 2116, 10160)
generateSql(data3, 21, 50, 2117, 10161)
generateSql(data3, 21, 51, 2117, 10162)
generateSql(data3, 21, 52, 2117, 10163)
generateSql(data3, 21, 53, 2118, 10164)
generateSql(data3, 21, 54, 2118, 10165)
generateSql(data3, 21, 55, 2118, 10166)
generateSql(data3, 21, 56, 2119, 10167)
generateSql(data3, 21, 57, 2119, 10168)
generateSql(data3, 21, 58, 2119, 10169)
generateSql(data3, 21, 59, 2120, 10170)
generateSql(data3, 21, 60, 2120, 10171)
generateSql(data3, 21, 61, 2120, 10172)
generateSql(data3, 21, 62, 2121, 10173)
generateSql(data3, 21, 63, 2121, 10174)
generateSql(data3, 21, 64, 2121, 10175)
generateSql(data3, 21, 65, 2122, 10176)
generateSql(data3, 21, 66, 2122, 10177)
generateSql(data3, 21, 67, 2122, 10178)
generateSql(data3, 21, 68, 2123, 10179)
generateSql(data3, 21, 69, 2123, 10180)
generateSql(data3, 21, 70, 2123, 10181)
generateSql(data3, 21, 71, 2124, 10182)
generateSql(data3, 21, 72, 2124, 10183)
generateSql(data3, 21, 73, 2124, 10184)
generateSql(data3, 21, 74, 2125, 10185)
generateSql(data3, 21, 75, 2125, 10186)
generateSql(data3, 21, 76, 2125, 10187)
generateSql(data3, 21, 77, 2126, 10188)
generateSql(data3, 21, 78, 2126, 10189)
generateSql(data3, 21, 79, 2126, 10190)
generateSql(data3, 21, 80, 2127, 10191)
generateSql(data3, 21, 81, 2127, 10192)
generateSql(data3, 21, 82, 2127, 10193)
generateSql(data3, 21, 83, 2128, 10194)
generateSql(data3, 21, 84, 2128, 10195)
generateSql(data3, 21, 85, 2128, 10196)
generateSql(data3, 21, 86, 2129, 10197)
generateSql(data3, 21, 87, 2129, 10198)
generateSql(data3, 21, 88, 2129, 10199)
generateSql(data3, 21, 89, 2130, 10200)
generateSql(data3, 21, 90, 2130, 10201)
generateSql(data3, 21, 91, 2130, 10202)
generateSql(data3, 21, 92, 2131, 10203)
generateSql(data3, 21, 93, 2131, 10204)
generateSql(data3, 21, 94, 2131, 10205)
generateSql(data3, 21, 95, 2132, 10206)
generateSql(data3, 21, 96, 2132, 10207)
generateSql(data3, 21, 97, 2132, 10208)
generateSql(data3, 22, 98, 'NULL', 10209)
generateSql(data3, 22, 99, 'NULL', 10210)
generateSql(data3, 22, 100, 'NULL', 10211)
generateSql(data3, 22, 101, 'NULL', 10212)
generateSql(data3, 22, 102, 'NULL', 10213)
generateSql(data3, 22, 103, 'NULL', 10214)
generateSql(data3, 23, 104, 'NULL', 10215)
generateSql(data3, 23, 105, 'NULL', 10216)
generateSql(data3, 23, 106, 'NULL', 10217)
generateSql(data3, 23, 107, 'NULL', 10218)
generateSql(data3, 23, 108, 'NULL', 10219)
generateSql(data3, 23, 109, 'NULL', 10220)
generateSql(data3, 23, 110, 'NULL', 10221)
generateSql(data3, 23, 111, 'NULL', 10222)
generateSql(data3, 24, 112, 'NULL', 10223)
generateSql(data3, 24, 113, 'NULL', 10224)
generateSql(data3, 24, 114, 'NULL', 10225)
generateSql(data3, 24, 115, 'NULL', 10226)
generateSql(data3, 24, 116, 'NULL', 10227)
generateSql(data3, 24, 117, 'NULL', 10228)
generateSql(data3, 24, 118, 'NULL', 10229)
generateSql(data3, 24, 119, 'NULL', 10230)
generateSql(data3, 24, 120, 'NULL', 10231)
generateSql(data3, 25, 121, 'NULL', 10232)
generateSql(data3, 25, 122, 'NULL', 10233)
generateSql(data3, 25, 123, 'NULL', 10234)
generateSql(data3, 25, 124, 'NULL', 10235)
generateSql(data3, 25, 125, 'NULL', 10236)
generateSql(data3, 25, 126, 'NULL', 10237)
generateSql(data3, 25, 127, 'NULL', 10238)
generateSql(data3, 25, 128, 'NULL', 10239)
generateSql(data3, 26, 129, 'NULL', 10240)
generateSql(data3, 26, 130, 'NULL', 10241)
generateSql(data3, 26, 131, 'NULL', 10242)
generateSql(data3, 26, 132, 'NULL', 10243)
generateSql(data3, 26, 133, 'NULL', 10244)
generateSql(data3, 26, 134, 'NULL', 10245)
generateSql(data3, 26, 135, 'NULL', 10246)
generateSql(data3, 26, 136, 'NULL', 10247)
generateSql(data3, 26, 137, 'NULL', 10248)
generateSql(data3, 27, 138, 'NULL', 10249)
generateSql(data3, 27, 139, 'NULL', 10250)
generateSql(data3, 27, 140, 'NULL', 10251)
generateSql(data3, 27, 141, 'NULL', 10252)
generateSql(data3, 27, 142, 'NULL', 10253)
generateSql(data3, 27, 143, 'NULL', 10254)
generateSql(data3, 27, 144, 'NULL', 10255)
generateSql(data3, 27, 145, 'NULL', 10256)
generateSql(data3, 28, 146, 'NULL', 10257)
generateSql(data3, 28, 147, 'NULL', 10258)
generateSql(data3, 28, 148, 'NULL', 10259)
generateSql(data3, 28, 149, 'NULL', 10260)
generateSql(data3, 28, 150, 'NULL', 10261)
generateSql(data3, 28, 151, 'NULL', 10262)
generateSql(data3, 28, 152, 'NULL', 10263)
generateSql(data3, 28, 153, 'NULL', 10264)
generateSql(data3, 28, 154, 'NULL', 10265)
generateSql(data3, 28, 155, 'NULL', 10266)
generateSql(data3, 29, 156, 'NULL', 10267)
generateSql(data3, 29, 157, 'NULL', 10268)
generateSql(data3, 29, 158, 'NULL', 10269)
generateSql(data3, 29, 159, 'NULL', 10270)
generateSql(data3, 29, 160, 'NULL', 10271)
generateSql(data3, 29, 161, 'NULL', 10272)
generateSql(data3, 29, 162, 'NULL', 10273)
generateSql(data3, 29, 163, 'NULL', 10274)
generateSql(data3, 29, 164, 'NULL', 10275)
generateSql(data3, 29, 165, 'NULL', 10276)
generateSql(data3, 30, 166, 'NULL', 10277)
generateSql(data3, 30, 167, 'NULL', 10278)
generateSql(data3, 30, 168, 'NULL', 10279)
generateSql(data3, 30, 169, 'NULL', 10280)
generateSql(data3, 30, 170, 'NULL', 10281)
generateSql(data3, 30, 171, 'NULL', 10282)
generateSql(data3, 30, 172, 'NULL', 10283)
generateSql(data3, 30, 173, 'NULL', 10284)
generateSql(data3, 30, 174, 'NULL', 10285)
generateSql(data3, 30, 175, 'NULL', 10286)
generateSql(data3, 31, 176, 'NULL', 10287)
generateSql(data3, 31, 177, 'NULL', 10288)
generateSql(data3, 31, 178, 'NULL', 10289)
generateSql(data3, 31, 179, 'NULL', 10290)
generateSql(data3, 31, 180, 'NULL', 10291)
generateSql(data3, 31, 181, 'NULL', 10292)
generateSql(data3, 31, 182, 'NULL', 10293)
generateSql(data3, 31, 183, 'NULL', 10294)
generateSql(data3, 31, 184, 'NULL', 10295)
generateSql(data3, 31, 185, 'NULL', 10296)
generateSql(data3, 32, 186, 'NULL', 'NULL')
# sheet 4 - QNUM: 33-43
generateSql(data4, 33, 2, 'NULL', 10297)
generateSql(data4, 33, 3, 'NULL', 10298)
generateSql(data4, 33, 4, 'NULL', 10299)
generateSql(data4, 33, 5, 'NULL', 10300)
generateSql(data4, 33, 6, 'NULL', 10301)
generateSql(data4, 33, 7, 'NULL', 10302)
generateSql(data4, 33, 8, 'NULL', 10303)
generateSql(data4, 33, 9, 'NULL', 10304)
generateSql(data4, 33, 10, 'NULL', 10305)
generateSql(data4, 33, 11, 'NULL', 10306)
generateSql(data4, 33, 12, 'NULL', 10307)
generateSql(data4, 34, 13, 'NULL', 10308)
generateSql(data4, 34, 14, 'NULL', 10309)
generateSql(data4, 34, 15, 'NULL', 10310)
generateSql(data4, 34, 16, 'NULL', 10311)
generateSql(data4, 34, 17, 'NULL', 10312)
generateSql(data4, 34, 18, 'NULL', 10313)
generateSql(data4, 34, 19, 'NULL', 10314)
generateSql(data4, 34, 20, 'NULL', 10315)
generateSql(data4, 34, 21, 'NULL', 10316)
generateSql(data4, 34, 22, 'NULL', 10317)
generateSql(data4, 34, 23, 'NULL', 10318)
generateSql(data4, 35, 24, 'NULL', 10319)
generateSql(data4, 35, 25, 'NULL', 10320)
generateSql(data4, 35, 26, 'NULL', 10321)
generateSql(data4, 35, 27, 'NULL', 10322)
generateSql(data4, 35, 28, 'NULL', 10323)
generateSql(data4, 35, 29, 'NULL', 10324)
generateSql(data4, 35, 30, 'NULL', 10325)
generateSql(data4, 36, 31, 'NULL', 'NULL')
generateSql(data4, 37, 32, 'NULL', 10326)
generateSql(data4, 37, 33, 'NULL', 10327)
generateSql(data4, 38, 34, 'NULL', 10328)
generateSql(data4, 38, 35, 'NULL', 10329)
generateSql(data4, 39, 36, 'NULL', 10330)
generateSql(data4, 40, 37, 4001, 10331)
generateSql(data4, 40, 38, 4001, 10332)
generateSql(data4, 40, 39, 4001, 10333)
generateSql(data4, 40, 40, 4001, 10334)
generateSql(data4, 40, 41, 4002, 10335)
generateSql(data4, 40, 42, 4002, 10336)
generateSql(data4, 40, 43, 4002, 10337)
generateSql(data4, 40, 44, 4002, 10338)
generateSql(data4, 40, 45, 4003, 10339)
generateSql(data4, 40, 46, 4003, 10340)
generateSql(data4, 40, 47, 4003, 10341)
generateSql(data4, 40, 48, 4003, 10342)
generateSql(data4, 40, 49, 4004, 10343)
generateSql(data4, 40, 50, 4004, 10344)
generateSql(data4, 40, 51, 4004, 10345)
generateSql(data4, 40, 52, 4004, 10346)
generateSql(data4, 40, 53, 4005, 10347)
generateSql(data4, 40, 54, 4005, 10348)
generateSql(data4, 40, 55, 4005, 10349)
generateSql(data4, 40, 56, 4005, 10350)
generateSql(data4, 40, 57, 4006, 10351)
generateSql(data4, 40, 58, 4006, 10352)
generateSql(data4, 40, 59, 4006, 10353)
generateSql(data4, 40, 60, 4006, 10354)
generateSql(data4, 40, 61, 4007, 10355)
generateSql(data4, 40, 62, 4007, 10356)
generateSql(data4, 40, 63, 4007, 10357)
generateSql(data4, 40, 64, 4007, 10358)
generateSql(data4, 40, 65, 4008, 10359)
generateSql(data4, 41, 66, 'NULL', 10360)
generateSql(data4, 41, 67, 'NULL', 10361)
generateSql(data4, 41, 68, 'NULL', 10362)
generateSql(data4, 42, 69, 'NULL', 10363)
generateSql(data4, 42, 70, 'NULL', 10364)
generateSql(data4, 43, 71, 'NULL', 10365)
generateSql(data4, 43, 72, 'NULL', 10366)
generateSql(data4, 43, 73, 'NULL', 10367)
generateSql(data4, 43, 74, 'NULL', 10368)
