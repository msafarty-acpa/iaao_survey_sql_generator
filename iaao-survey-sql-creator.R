#dependencies
library(readxl)
library(dplyr)
#break out into separate spreadsheets (load version with JPTAA context manually added in)
data1<-readxl::read_excel('2017_PTAPP-web-withJPTAA.xlsx', sheet = 1) %>% dplyr::select(-c(1,2,3))
data2<-readxl::read_excel('2017_PTAPP-web-withJPTAA.xlsx', sheet = 2)  %>% dplyr::select(-c(1,2,3))
data3<-readxl::read_excel('2017_PTAPP-web-withJPTAA.xlsx', sheet = 3)  %>% dplyr::select(-c(1,2,3))
data4<-readxl::read_excel('2017_PTAPP-web-withJPTAA.xlsx', sheet = 4)  %>% dplyr::select(-c(1,2,3)) 



#test to see if we truncate lengthy responses
#data2$...68[67] #testing to see if lengthy response is truncated

#escape apostrophes that may be found in the Excel data; this will mess up SQL
data1 <- data.frame(lapply(data1, function(x) {
  gsub("'","''",x)
}))
data2 <- data.frame(lapply(data2, function(x) {
  gsub("'","''",x)
}))
data3 <- data.frame(lapply(data3, function(x) {
  gsub("'","''",x)
}))
data4 <- data.frame(lapply(data4, function(x) {
  gsub("'","''",x)
}))


# remove extra row
data1<- data1[-c(1,2),]
# categories introduce an extra row in these sheets; not present in the first 10 Qs
data2<- data2[-c(1,2,3),]
data3<- data3[-c(1,2,3),]
data4<- data4[-c(1,2,3),]



#create SQL generation function based on data structure
generateSql <- function(dataset, qnum, colnum, category, subQ) {
  sqlText <- dataset[1:nrow(dataset),colnum]
  # print(sqlText)
  for (row in 1:nrow(dataset)) {
    cat(paste0("(2, ", 1000+row, ", 2017, ",qnum, ", ", category, ", ", 
               subQ,", '", sqlText[row], "'),\n"))#, quote = F)
  }                
}

# Open text file, write function output into it without R idiosyncrasies forcing us to use text replace
### had to add the multiple insert into statements to avoid sql server limit of 1000 inserts. also, one must manually remove the final comma in the last set of values before the next "insert into" statement. I think we may need to insert into SQL pre-tabularized data, or come up with something more elegant.
### NOTEPAD++ allows for replace over multiple lines, therefore can replace the phrase ",INSERT INTO" and remove the preceding commas for mass insert.
sink("insertResponsesDetailed.txt") 
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 3, 1, 'NULL','NULL')
# cat('INSERT INTO dbo.responses_detail VALUES ')
# generateSql(data1, 4, 2, 'NULL','NULL')
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 4, 2, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 4, 3, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 4, 4, 'NULL', 3) 
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 5, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 6, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 7, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 8, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 9, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 10, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 11, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 12, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 13, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 14, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 15, 'NULL', 11)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 16, 'NULL', 12)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 17, 'NULL', 13)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 18, 'NULL', 14)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 19, 'NULL', 15)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 20, 'NULL', 16)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 5, 21, 'NULL', 17)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 6, 22, 'NULL', 'NULL')
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 7, 23, 'NULL', 'NULL')
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 24, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 25, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 26, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 27, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 28, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 29, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 30, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 31, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 32, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 33, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 34, 'NULL', 11)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 35, 'NULL', 12)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 36, 'NULL', 13)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 37, 'NULL', 14)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 38, 'NULL', 15)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 39, 'NULL', 16)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 40, 'NULL', 17)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 41, 'NULL', 18)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 42, 'NULL', 19)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 43, 'NULL', 20)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 8, 44, 'NULL', 21)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 9, 45, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 9, 46, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 9, 47, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 48, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 49, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 50, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 51, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 52, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 53, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 54, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 55, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 56, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 57, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data1, 10, 58, 'NULL', 11)
cat('INSERT INTO dbo.responses_detail VALUES ')






#excel question 11 on separate sheet
generateSql(data2, 11, 1, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 11, 2, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 11, 3, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 11, 4, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 12, 5, 'NULL', 'NULL')
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 13, 6, 'NULL', 'NULL')
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 14, 7, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 14, 8, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 15, 9, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 15, 10, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 15, 11, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 12, 1, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 13, 1, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 14, 1, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 15, 2, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 16, 2, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 17, 2, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 18, 3, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 19, 3, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 20, 3, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 21, 4, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 22, 4, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 23, 4, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 24, 5, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 25, 5, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 26, 5, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 27, 6, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 28, 6, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 29, 6, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 30, 7, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 31, 7, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 32, 7, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 16, 33, 8, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 34, 1, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 35, 1, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 36, 1, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 37, 2, 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 38, 2, 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 39, 2, 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 40, 3, 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 41, 3, 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 42, 3, 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 43, 4, 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 44, 4, 11)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 45, 4, 12)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 17, 46, 5, 13)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 47, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 48, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 49, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 50, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 51, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 52, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 53, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 54, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 18, 55, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 19, 56, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 19, 57, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 20, 58, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 20, 59, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 20, 60, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 20, 61, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 20, 62, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 20, 63, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 20, 64, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data2, 20, 65, 'NULL', 8)

# spreadsheet tab 3 for q21-32
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 1, 1, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 2, 1, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 3, 1, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 4, 2, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 5, 2, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 6, 2, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 7, 3, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 8, 3, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 9, 3, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 10, 4, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 11, 4, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 12, 4, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 13, 5, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 14, 5, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 15, 5, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 16, 6, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 17, 6, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 18, 6, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 19, 7, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 20, 7, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 21, 7, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 22, 8, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 23, 8, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 24, 8, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 25, 9, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 26, 9, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 27, 9, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 28, 10, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 29, 10, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 30, 10, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 31, 11, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 32, 11, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 33, 11, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 34, 12, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 35, 12, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 36, 12, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 37, 13, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 38, 13, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 39, 13, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 40, 14, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 41, 14, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 42, 14, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 43, 15, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 44, 15, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 45, 15, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 46, 16, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 47, 16, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 48, 16, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 49, 17, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 50, 17, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 51, 17, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 52, 18, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 53, 18, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 54, 18, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 55, 19, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 56, 19, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 57, 19, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 58, 20, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 59, 20, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 60, 20, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 61, 21, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 62, 21, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 63, 21, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 64, 22, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 65, 22, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 66, 22, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 67, 23, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 68, 23, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 69, 23, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 70, 24, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 71, 24, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 72, 24, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 73, 25, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 74, 25, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 75, 25, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 76, 26, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 77, 26, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 78, 26, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 79, 27, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 80, 27, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 81, 27, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 82, 28, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 83, 28, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 84, 28, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 85, 29, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 86, 29, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 87, 29, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 88, 30, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 89, 30, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 90, 30, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 91, 31, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 92, 31, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 93, 31, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 94, 32, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 95, 32, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 21, 96, 32, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 22, 97, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 22, 98, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 22, 99, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 22, 100, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 22, 101, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 22, 102, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 23, 103, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 23, 104, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 23, 105, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 23, 106, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 23, 107, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 23, 108, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 23, 109, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 23, 110, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 111, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 112, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 113, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 114, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 115, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 116, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 117, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 118, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 24, 119, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 25, 120, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 25, 121, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 25, 122, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 25, 123, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 25, 124, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 25, 125, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 25, 126, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 25, 127, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 128, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 129, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 130, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 131, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 132, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 133, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 134, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 135, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 26, 136, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 27, 137, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 27, 138, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 27, 139, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 27, 140, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 27, 141, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 27, 142, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 27, 143, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 27, 144, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 145, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 146, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 147, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 148, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 149, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 150, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 151, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 152, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 153, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 28, 154, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 155, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 156, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 157, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 158, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 159, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 160, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 161, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 162, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 163, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 29, 164, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 165, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 166, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 167, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 168, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 169, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 170, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 171, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 172, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 173, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 30, 174, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 175, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 176, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 177, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 178, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 179, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 180, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 181, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 182, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 183, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 31, 184, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data3, 32, 185, 'NULL', 'NULL')




# sheet 4 - QNUM: 33-43
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 1, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 2, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 3, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 4, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 5, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 6, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 7, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 8, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 9, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 10, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 33, 11, 'NULL', 11)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 12, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 13, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 14, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 15, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 16, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 17, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 18, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 19, 'NULL', 8)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 20, 'NULL', 9)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 21, 'NULL', 10)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 34, 22, 'NULL', 11)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 35, 23, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 35, 24, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 35, 25, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 35, 26, 'NULL', 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 35, 27, 'NULL', 5)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 35, 28, 'NULL', 6)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 35, 29, 'NULL', 7)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 36, 30, 'NULL', 'NULL')
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 37, 31, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 37, 32, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 38, 33, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 38, 34, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 39, 35, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 36, 1, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 37, 3, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 38, 2, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 39, 1, 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 40, 2, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 41, 2, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 42, 2, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 43, 2, 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 44, 3, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 45, 3, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 46, 3, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 47, 3, 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 48, 4, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 49, 4, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 50, 4, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 51, 4, 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 52, 5, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 53, 5, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 54, 5, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 55, 5, 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 56, 6, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 57, 6, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 58, 6, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 59, 6, 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 60, 7, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 61, 7, 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 62, 7, 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 63, 7, 4)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 40, 64, 8, 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 41, 65, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 41, 66, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 41, 67, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 42, 68, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 42, 69, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 43, 70, 'NULL', 1)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 43, 71, 'NULL', 2)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 43, 72, 'NULL', 3)
cat('INSERT INTO dbo.responses_detail VALUES ')
generateSql(data4, 43, 73, 'NULL', 4)
sink()
